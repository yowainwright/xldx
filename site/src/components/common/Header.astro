---
import ThemeToggle from "./ThemeToggle.astro";
import Search from "../docs/Search";
import { resolveUrl, resolveDocsUrl } from "../../utils/urlResolver";
import { getSearchData } from "../../utils/searchData";
import { Target } from 'lucide-react';

interface Props {
  showSearch?: boolean;
  showSidebarToggle?: boolean;
}

const { showSearch = true, showSidebarToggle = false } = Astro.props;

const navigation = [
  {
    title: "Home",
    href: resolveUrl(""),
  },
  {
    title: "Docs",
    href: resolveDocsUrl("introduction"),
  },
];

const pathname = new URL(Astro.request.url).pathname;
const searchData = await getSearchData();
---

<header class="sticky top-0 w-full z-50 -mx-[50vw] ml-[calc(-50vw+50%)] mr-[calc(-50vw+50%)]">
  <nav
    class="navbar bg-base-100/80 border-b border-base-content/10 backdrop-blur-3xl justify-center items-center py-2 px-4 sm:px-6 md:px-8 font-outfit w-full"
  >
    <div class="navbar-start">
      {showSidebarToggle && (
        <label for="my-drawer-2" class="btn btn-square btn-ghost lg:hidden mr-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            class="inline-block w-5 h-5 stroke-current"
            ><path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </label>
      )}
      
      {!showSidebarToggle && (
        <div class="dropdown lg:hidden">
          <div tabindex="0" role="button" class="btn btn-ghost btn-square">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h8m-8 6h16"></path></svg
            >
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-[50] p-2 shadow-lg bg-base-100 rounded-box w-52 border border-base-content/10 space-y-1"
          >
            {
              navigation.map((item) => (
                <li>
                  <a
                    class={`py-2 px-3 hover:text-primary hover:bg-primary/10 transition flex ${pathname === item.href ? "text-primary bg-primary/10" : ""}`}
                    href={item.href}
                  >
                    {item.title}
                  </a>
                </li>
              ))
            }
          </ul>
        </div>
      )}

      <a href={resolveUrl("")} class="btn btn-ghost px-1 sm:px-2">
        <h1 class="flex items-center">
          <span class="text-lg sm:text-xl md:text-2xl font-bold text-primary relative" style="font-family: var(--font-brand);">
            xldx<Target className="absolute -top-0.5 -right-3 sm:-right-3.5 md:-right-4 w-2.5 h-2.5 sm:w-3 sm:h-3 md:w-3.5 md:h-3.5 text-primary" />
          </span>
        </h1>
      </a>


    </div>

    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal text-base font-medium space-x-2">
        {
          navigation.map((item) => (
            <li>
              <a
                class={`py-2 px-4 hover:text-primary hover:bg-primary/10 transition flex ${pathname === item.href ? "text-primary bg-primary/10" : ""}`}
                href={item.href}
              >
                {item.title}
              </a>
            </li>
          ))
        }
      </ul>
    </div>

    <div class="navbar-end">
      {searchData && (
        <div class="mr-2 sm:mr-4">
          <Search client:load searchData={searchData} />
        </div>
      )}
      
      <a
        class="btn btn-sm btn-ghost btn-square"
        href="https://github.com/yowainwright/xldx"
        aria-label="github"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 16 16"
          class="h-4 w-4"
          ><path
            d="M7.999 0C3.582 0 0 3.596 0 8.032a8.031 8.031 0 0 0 5.472 7.621c.4.074.546-.174.546-.387 0-.191-.007-.696-.011-1.366-2.225.485-2.695-1.077-2.695-1.077-.363-.928-.888-1.175-.888-1.175-.727-.498.054-.488.054-.488.803.057 1.225.828 1.225.828.714 1.227 1.873.873 2.329.667.072-.519.279-.873.508-1.074-1.776-.203-3.644-.892-3.644-3.969 0-.877.312-1.594.824-2.156-.083-.203-.357-1.02.078-2.125 0 0 .672-.216 2.2.823a7.633 7.633 0 0 1 2.003-.27 7.65 7.65 0 0 1 2.003.271c1.527-1.039 2.198-.823 2.198-.823.436 1.106.162 1.922.08 2.125.513.562.822 1.279.822 2.156 0 3.085-1.87 3.764-3.652 3.963.287.248.543.738.543 1.487 0 1.074-.01 1.94-.01 2.203 0 .215.144.465.55.386A8.032 8.032 0 0 0 16 8.032C16 3.596 12.418 0 7.999 0z"
            fill="currentColor"></path>
        </svg>
      </a>
      <ThemeToggle />
    </div>
  </nav>
</header>