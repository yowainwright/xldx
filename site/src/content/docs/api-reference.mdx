---
title: API Reference
description: "Complete API documentation for xldx"
---

import CodeBlock from '../../components/docs/CodeBlock.astro';

# API Reference

## Constructor

<CodeBlock code={`new Xldx(data: DataRow[] | SheetsData, options?: XldxOptions)`} />

Creates a new Xldx instance.

### Parameters

- `data` - Array of data objects or sheet data structure
- `options` - Optional configuration object

## Methods

### `createSheet()`

<CodeBlock code={`createSheet(options: SheetOptions, ...columns: ColumnDefinition[]): this`} />

Creates a new worksheet with specified columns.

### `setTheme()`

<CodeBlock code={`setTheme(theme: ColorTheme): this`} />

Sets the color theme for styling.

### `toBuffer()` (node, bun, or deno only)

<CodeBlock code={`async toBuffer(): Promise<Buffer>`} />

Generates Excel file as a Buffer.

### `toBlob()` (Browser only)

<CodeBlock code={`async toBlob(): Promise<Blob>`} />

Generates Excel file as a Blob.

### `toUint8Array()`

<CodeBlock code={`async toUint8Array(): Promise<Uint8Array>`} />

Generates Excel file as Uint8Array.

### `download()` (Browser only)

<CodeBlock code={`async download(filename?: string): Promise<void>`} />

Triggers file download in the browser.

### `write()` (node, bun, or deno only)

<CodeBlock code={`async write(filePath: string): Promise<void>`} />

Writes Excel file to disk.

### `getSheetData()`

<CodeBlock code={`getSheetData(sheet: string | number): SheetDataAPI`} />

Returns an API for manipulating sheet data after creation.

## Types

### `ColumnDefinition`

<CodeBlock code={`interface ColumnDefinition {
  key: string;
  header?: string;
  width?: number | 'auto';
  style?: CellStyle;
  patterns?: {
    bgColorPattern?: string | PatternFunction;
    textPattern?: string | PatternFunction;
  };
}`} />

### `SheetOptions`

<CodeBlock code={`interface SheetOptions {
  name: string;
  freezePane?: {
    row: number;
    column: number;
  };
  showGridLines?: boolean;
}`} />

## Pattern Functions

xldx includes built-in pattern functions:

- `zebraBg` - Alternating row colors
- `bgColorBasedOnDiff` - Background color based on value changes
- `txtColorBasedOnDiff` - Text color based on value changes