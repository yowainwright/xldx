---
title: Validation Plugin
description: Add data validation rules including dropdowns and constraints
order: 14
---

# Validation Plugin

Add data validation rules to cells including dropdown lists, numeric constraints, text length limits, and custom formulas.

## Installation

```bash
bun add @xldx/validation
```

## Usage

```typescript
import { Xldx } from 'xldx';
import { validationPlugin, addValidation } from '@xldx/validation';

const plugin = validationPlugin();

const xldx = new Xldx(data)
  .use(plugin)
  .createSheet({ name: 'Form' }, ...columns);

// Dropdown list
addValidation(plugin, {
  sheet: 'Form',
  type: 'list',
  range: 'B2:B100',
  values: ['Option 1', 'Option 2', 'Option 3']
});

// Number constraint
addValidation(plugin, {
  sheet: 'Form',
  type: 'whole',
  range: 'C2:C100',
  operator: 'between',
  value1: 1,
  value2: 100
});

const xlsx = await xldx.toUint8Array();
```

## Validation Types

### List (Dropdown)

Create a dropdown selection.

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'list',
  range: 'A1:A10',
  values: ['Red', 'Green', 'Blue'],
  showDropDown: true  // optional, default true
});
```

### Whole Number

Constrain to integer values.

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'whole',
  range: 'B1:B10',
  operator: 'greaterThan',
  value1: 0
});

// Between range
addValidation(plugin, {
  sheet: 'Form',
  type: 'whole',
  range: 'B1:B10',
  operator: 'between',
  value1: 1,
  value2: 100
});
```

### Decimal Number

Constrain to decimal values.

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'decimal',
  range: 'C1:C10',
  operator: 'lessThanOrEqual',
  value1: 99.99
});
```

### Text Length

Constrain text length.

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'textLength',
  range: 'D1:D10',
  operator: 'lessThanOrEqual',
  value1: 50
});
```

### Custom Formula

Use a formula for validation.

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'custom',
  range: 'E1:E10',
  formula: '=AND(E1>0, E1<A1)'
});
```

## Operators

| Operator | Description |
|----------|-------------|
| `equal` | Value must equal |
| `notEqual` | Value must not equal |
| `greaterThan` | Value must be greater than |
| `lessThan` | Value must be less than |
| `greaterThanOrEqual` | Value must be greater than or equal |
| `lessThanOrEqual` | Value must be less than or equal |
| `between` | Value must be between (requires value1 and value2) |
| `notBetween` | Value must not be between |

## Options

All validation rules support these optional settings:

```typescript
addValidation(plugin, {
  sheet: 'Form',
  type: 'list',
  range: 'A1:A10',
  values: ['Yes', 'No'],

  // Input message (shown when cell is selected)
  showInputMessage: true,
  promptTitle: 'Selection Required',
  prompt: 'Please select Yes or No',

  // Error message (shown on invalid input)
  showErrorMessage: true,
  errorStyle: 'stop',  // 'stop' | 'warning' | 'information'
  errorTitle: 'Invalid Entry',
  error: 'Please select a value from the list',

  // Allow blank values
  allowBlank: true
});
```

## Examples

### Data Entry Form

```typescript
// Status dropdown
addValidation(plugin, {
  sheet: 'Form',
  type: 'list',
  range: 'B2:B100',
  values: ['Active', 'Inactive', 'Pending'],
  promptTitle: 'Status',
  prompt: 'Select the current status'
});

// Age (1-120)
addValidation(plugin, {
  sheet: 'Form',
  type: 'whole',
  range: 'C2:C100',
  operator: 'between',
  value1: 1,
  value2: 120,
  errorTitle: 'Invalid Age',
  error: 'Please enter an age between 1 and 120'
});

// Email validation (custom)
addValidation(plugin, {
  sheet: 'Form',
  type: 'custom',
  range: 'D2:D100',
  formula: '=ISNUMBER(FIND("@",D2))'
});
```
